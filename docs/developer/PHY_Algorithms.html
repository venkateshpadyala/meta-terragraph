<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-developer/PHY_Algorithms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="search" type="application/opensearchdescription+xml" title="Terragraph" href="/opensearch.xml">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">PHY Algorithms | Terragraph</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://terragraph.com/logo/terragraph-logo-full-RGB.png"><meta data-rh="true" name="twitter:image" content="https://terragraph.com/logo/terragraph-logo-full-RGB.png"><meta data-rh="true" property="og:url" content="https://terragraph.com/docs/developer/PHY_Algorithms"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="PHY Algorithms | Terragraph"><meta data-rh="true" name="description" content="This document describes the configuration of some physical (PHY) layer"><meta data-rh="true" property="og:description" content="This document describes the configuration of some physical (PHY) layer"><link data-rh="true" rel="icon" href="/logo/terragraph-logo-favicon-32x32-full-RGB.png"><link data-rh="true" rel="canonical" href="https://terragraph.com/docs/developer/PHY_Algorithms"><link data-rh="true" rel="alternate" href="https://terragraph.com/docs/developer/PHY_Algorithms" hreflang="en"><link data-rh="true" rel="alternate" href="https://terragraph.com/docs/developer/PHY_Algorithms" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://TB9T0CGM6Y-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.48218837.css">
<link rel="preload" href="/assets/js/runtime~main.ee1b3ecd.js" as="script">
<link rel="preload" href="/assets/js/main.feb34f19.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/logo/terragraph-logo-favicon-32x32-full-RGB.svg" alt="Terragraph Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/logo/terragraph-logo-favicon-32x32-white-RGB.svg" alt="Terragraph Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/terragraph/meta-terragraph" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link githubButton navbarIconButton" title="GitHub"></a><a href="https://discord.gg/HQaxCevzus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link discordButton navbarIconButton" title="Discord"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/runbook">Runbook</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/developer">Developer Manual</a></li><li><a class="dropdown__link" href="/docs/whitepapers">Whitepapers</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/developer">Developer Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer/Overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/developer/Communication_Protocol">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/developer/Beamforming_Link_Adaptation">Firmware Layer</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer/Beamforming_Link_Adaptation">Beamforming and Link Adaptation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer/MAC_PHY_Specification">MAC &amp; PHY Specification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developer/PHY_Algorithms">PHY Algorithms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developer/Firmware_Stats">Firmware Stats</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/developer/Topology_Management">End-to-End (E2E) Service</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/developer/Stats_Events_Logs">Application Layer Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/developer/Service_Scripts">System Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/developer/Release_Conventions">Version Control</a></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/developer"><span itemprop="name">Developer Manual</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Firmware Layer</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">PHY Algorithms</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>PHY Algorithms</h1><p>This document describes the configuration of some physical (PHY) layer
algorithms.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="maximum-agc--minimum-rssi">Maximum AGC &amp; Minimum RSSI<a class="hash-link" href="#maximum-agc--minimum-rssi" title="Direct link to heading">​</a></h2><p>To limit early-weak interference, Terragraph includes a feature to either limit
the maximum automatic gain control (AGC) gain or the minimum received signal
strength indicator (RSSI). An interfering signal that is below the minimum RSSI
threshold or requires a gain above the maximum AGC limit will not be detected.
An algorithm running in the firmware tracks the gain and RSSI of the desired
signal, and limits the maximum AGC and minimum RSSI at some margin from the
desired signal.</p><p>The AGC has an IF and RF gain component. The overall gain (in dB) is calculated
as follows, using configurable vendor-specific coefficients <code>a</code> (default 1.0)
and <code>b</code> (default 7.0):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gain = a*IF + b*RF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For example, if the AGC of the desired signal is <code>IF = 3, RF = 2</code> and the
corresponding <code>RSSI = -40dBm</code>, the maximum AGC could be set to <code>IF = 4, RF = 3</code>
and <code>minRSSI = -48dBm</code>. Any signal requiring a gain greater than
<code>IF = 4, RF = 3</code> or having <code>RSSI &lt; -48dBm</code> would not be detected.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-description">Algorithm Description<a class="hash-link" href="#algorithm-description" title="Direct link to heading">​</a></h3><p>The hardware provides the measured RSSI value, and optionally the IF and RF
gains and the <em>raw</em> analog-to-digital converter (ADC) RSSI, i.e. the RSSI
measured after gains are applied. The algorithm can either calculate a relative
RSSI based on the gains and raw RSSI (if <code>useMinRssi</code> is not set) or use the
measured RSSI (if <code>useMinRssi</code> is set).</p><p>When <code>useMinRssi</code> is not set, the relative RSSI is calculated as follows, using
a configurable coefficient <code>c</code> (default 0.5):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">relativeRSSI = c*rawAdcRssi - a*IF - b*RF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The algorithm filters the RSSI using a &quot;fast drop slow rise&quot; infinite impulse
response (IIR) filter, and then computes the maximum AGC and minimum RSSI using
the filtered output and a configured margin.</p><p>In summary:</p><ol><li>RSSI is reported by the PHY.</li><li>Filter the RSSI using &quot;fast drop slow rise&quot; IIR filter.</li><li>Subtract the configurable margin from the filtered RSSI (this is the minimum
RSSI).</li><li>Optionally, calculate the corresponding IF and RF gains.</li><li>Configure the hardware with either the minimum RSSI or the maximum AGC IF and
RF gains.</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="calculating-gains">Calculating Gains<a class="hash-link" href="#calculating-gains" title="Direct link to heading">​</a></h3><p>The IF and RF gains are calculated given the RSSI target, and are configured
using vendor-proprietary indices. By default, this assumes 1.0dB per IF index
and 7.0dB per RF index (as mentioned above). There is also a vendor-proprietary
and configurable range for each index. By default, the IF gain index can be
<!-- -->[0:31]<!-- --> and the RF gain index can be <!-- -->[0:5]<!-- -->.</p><p>When <code>useMinRssi</code> is not set and the raw ADC RSSI is reported, the actual raw
ADC RSSI might differ from the desired raw ADC RSSI target. The IF and RF gains
are normally set such that the raw ADC RSSI will hit a desired target, ensuring
the signal does not clip and thus minimizing quantization noise. If the reported
raw ADC RSSI is not equal to the desired level, the gains are adjusted
accordingly.</p><p>The mapping from RSSI to IF and RF gains is not unique given the ranges above;
for example, <code>IF = 3, RF = 2</code> and <code>IF = 10, RF = 1</code> both have the same gain. To
deal with this, a &quot;sweet&quot; IF gain range can be configured such that RF gain will
be chosen to keep the IF gain within the &quot;sweet&quot; range. By default, this is
between 7 and 17. By keeping the sweet range larger than the RF gain step,
thrashing can be prevented where the IF and RF gains keep switching back and
forth, e.g. between <code>IF = 3, RF = 2</code> and <code>IF = 9, RF = 1</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="details">Details<a class="hash-link" href="#details" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">target RSSI = filtered RSSI - margin = -a*XIF -b*XRF + c*targetRawAdc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>XIF</code> and <code>XRF</code> are the desired gains to calculate. <code>targetRawAdc</code> is a
configurable input (default -14), and <code>margin</code> is the configurable margin (in
dB).</p><p>Let target gain be defined as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">targetGain := filtered RSSI - margin - c*targetRawAdc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Given that <code>XRF</code> is the current RF gain, <code>XIF</code> is calculated as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">XRF = current RF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XIF = -(targetGain + b*XRF) / a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, if <code>XIF</code> is outside the sweet range, <code>XRF</code> is incremented or decremented to
try and move it into the sweet range, or until hitting the RF range limit.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="p2mp">P2MP<a class="hash-link" href="#p2mp" title="Direct link to heading">​</a></h3><p>In a point-to-multipoint scenario, a node receives signals from multiple sources
and the RSSI from each source can differ. There is a configurable option to set
the maximum gain and minimum RSSI to the smallest amongst all signals, or to set
each maximum gain and minimum RSSI separately for each station (i.e. link).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rf-gain-hilo">RF Gain Hi/Lo<a class="hash-link" href="#rf-gain-hilo" title="Direct link to heading">​</a></h3><p>This is a vendor-proprietary option where RF gain selection (1 or 0) is selected
according to the measured SNR and a threshold, including hysteresis
(hysteresis is 1dB - not configurable):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if SNR &gt; threshold + hysteresis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RFgain = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if SNR &lt; threshold - hysteresis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RFgain = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if threshold - hysteresis &lt; SNR &lt; threshold + hysteresis:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RFgain remains at the current setting</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-options">Configuration Options<a class="hash-link" href="#configuration-options" title="Direct link to heading">​</a></h3><p>The firmware configuration options for AGC are listed in the table below.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>maxAgcIfGaindBperIndexQ8</code></td><td>The <code>a</code> coefficient above (default 1.0dB)</td></tr><tr><td><code>maxAgcMaxRfGainIndex</code></td><td>The maximum allowed RF gain index (default 5)</td></tr><tr><td><code>maxAgcMinRfGainIndex</code></td><td>The minimum allowed RF gain index (default 0)</td></tr><tr><td><code>maxAgcMaxIfGainIndex</code></td><td>The maximum allowed IF gain index (default 31)</td></tr><tr><td><code>maxAgcMinIfGainIndex</code></td><td>The minimum allowed IF gain index (default 0)</td></tr><tr><td><code>maxAgcMaxIfSweetGainRange</code></td><td>See discussion on sweet IF range above (default 17)</td></tr><tr><td><code>maxAgcMinIfSweetGainRange</code></td><td>See discussion on sweet IF range above (default 7)</td></tr><tr><td><code>maxAgcMinRssi</code></td><td>If maximum AGC tracking is disabled, a fixed value can be used for minRSSI or maximum AGC (based on <code>useMinRssi</code>) (default -40)</td></tr><tr><td><code>maxAgcRawAdcScaleFactorQ8</code></td><td>The <code>c</code> coefficient above (default 0.5dB)</td></tr><tr><td><code>maxAgcRfGaindBperIndexQ8</code></td><td>The <code>b</code> coefficient above (default 7.0dB)</td></tr><tr><td><code>maxAgcTargetRawAdc</code></td><td>The target raw ADC RSSI described above (default -14)</td></tr><tr><td><code>maxAgcTrackingEnabled</code></td><td>Enables run-time tracking (default 1)</td></tr><tr><td><code>maxAgcTrackingMargindB</code></td><td>The margin described above (default 7dB)</td></tr><tr><td><code>maxAgcUseMinRssi</code></td><td>Determines whether to use minRSSI or maximum AGC (default 0)</td></tr><tr><td><code>maxAgcUseSameForAllSta</code></td><td>See discussion on P2MP above (default 1)</td></tr><tr><td><code>maxAgcRfGainHiLo</code></td><td>Setting bit 0 to <code>1</code> enables the feature; bits 15:8 represent the threshold (dB) (default 0)</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-agc-configuration">Dynamic AGC Configuration<a class="hash-link" href="#dynamic-agc-configuration" title="Direct link to heading">​</a></h3><p>There are two mechanisms for changing AGC parameters on-the-fly while a link
is up without interrupting service. These mechanisms are described below.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-fw_config_req">Using FW_CONFIG_REQ<a class="hash-link" href="#using-fw_config_req" title="Direct link to heading">​</a></h4><p>The <code>FW_CONFIG_REQ</code> command can be issued via the TG CLI or r2d2, instructing
the E2E minion to apply new firmware parameters on-the-fly.</p><p>This method supports only a subset of all firmware parameters. The available
parameters can be listed using the TG CLI:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tg fw node -n &lt;any dummy value&gt; set_fw_params -s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example usage:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Set a link parameter via TG CLI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg fw node -n &lt;node name&gt; set_fw_params -r &lt;peer node name&gt; &lt;parameter&gt; &lt;value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set a link parameter via r2d2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ r2d2 fw_set_params -m &lt;peer MAC address&gt; &lt;parameter&gt; &lt;value&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Get the current value of a link parameter via TG CLI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ tg fw node -n &lt;node name&gt; get_fw_params linkParams -r &lt;peer node name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-phyagcparams">Using PhyAgcParams<a class="hash-link" href="#using-phyagcparams" title="Direct link to heading">​</a></h4><p>The entire <code>PhyAgcParams</code> Thrift structure can be passed via r2d2 only, which
issues the same <code>FW_CONFIG_REQ</code> command from above to the driver interface:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ r2d2 phyagc_config -m &lt;peer mac&gt; -f &lt;configuration file&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example configuration file is included in the node image at
<code>/etc/e2e_config/fw_phyagc_cfg.json</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="link-adaptation-and-transmit-power-control-latpc">Link Adaptation and Transmit Power Control (LA/TPC)<a class="hash-link" href="#link-adaptation-and-transmit-power-control-latpc" title="Direct link to heading">​</a></h2><p>The modulation and code rate (MCS) and transmit power are both adaptive values,
and are set at the transmitter independently for every link and for both
directions. The adaptive MCS selection procedure is referred to as <em>link
adaptation (LA)</em>, and the transmit power procedure as <em>transmit power control
(TPC)</em>. Both procedures can be enabled or disabled independently at
initialization time or runtime.</p><p>The algorithm is driven by an <em>offset</em>. The offset increases as feedback
indicates good behavior and reduces as feedback indicates negative behavior.
When the offset crosses a fixed threshold (+1dB), MCS generally increases or
power generally decreases. The opposite is true if the offset crosses a negative
fixed threshold (-0.5dB). After crossing a threshold, the offset returns to
zero. The offset can never go outside the range +/- 2dB. The algorithm tries to
maximize throughput first by maximizing the MCS, then it will reduce power.</p><p>When there is data traffic, the offset is driven by the LDPC-based block error
rate (BLER) reported every SF (1.6ms). A lower BLER causes the algorithm to
increase the offset. When there is no data traffic, the algorithm is driven by
the STF SNR as reported each mgmt packet (every BWGD). The SNR is compared to
the MCS table and if the SNR &gt; (&lt;) table value, the offset will
increase (decrease).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="traffic-driven-mode">Traffic-Driven Mode<a class="hash-link" href="#traffic-driven-mode" title="Direct link to heading">​</a></h3><p>Every superframe (SF), a new set of LDPC statistics is received.  A <code>deltaOffset</code>
is calculated:</p><ul><li><code>deltaOffset = (1-PER)*convergenceFactor/nackWeightFactor - PER*convergenceFactor</code><ul><li>default convergenceFactor = 1.0dB</li><li>default nackWeightFactor is 200 (5e-3 target PER)</li><li>PER is calculated from the syndrome error rate<ul><li>PER = nSyn/nCW*bler2perFactor<ul><li>nSyn = syndrome count over the last SF</li><li>nCW = number of LDPC codewords over the last SF</li><li>bler2perFactor: see BLER to PER below</li></ul></li></ul></li></ul></li><li><code>offset = offset + deltaOffset</code></li></ul><p>The speed of the algorithm is determined by <code>convergenceFactor</code> and the
target PER is by <code>nackWeightFactor</code>.  Both are configurable as a FW
parameter.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-traffic-mode">No-Traffic Mode<a class="hash-link" href="#no-traffic-mode" title="Direct link to heading">​</a></h3><p>The traffic-driven mode uses LDPC statistics to drive the MCS/txPower. If no (or
very few) data packets are sent, there are no LDPC statistics. In this case, we
use the no-traffic mode which uses an MCS table lookup based on SNR.</p><ul><li>Detection of traffic:<ul><li>if, in any one SF, there are no transmitted MPDUs, then
<code>noTrafficDuration++</code></li><li>if there is no traffic for 125 superframes (200ms total, not
configurable), then move to the no-traffic mode</li><li>as soon as &gt;=1 MDPUs are transmitted, algorithm sets noTrafficDuration = 0
and moves back to traffic mode</li></ul></li></ul><p>In no-traffic mode:</p><ul><li>max MCS = min(configured max MCS, noTrafficMaxMcsFallback)</li><li>default noTrafficMaxMcsFallback is 9 (configurable)</li><li>offset = <code>effective SNR - MCStable[curMCS]</code> (note: this is not the
deltaOffset, it&#x27;s the offset)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="core-algorithm">Core Algorithm<a class="hash-link" href="#core-algorithm" title="Direct link to heading">​</a></h3><p>The core algorithm takes the offset and current MCS and txPower and returns the
new MCS and txPower.  When the offset crosses the negative threshold (-0.5dB),
MCS and power follow the &quot;Bad&quot; Path and follow the &quot;Good&quot; Path when the offset
crosses the positive threshold (+1.0dB).</p><ul><li>if offset &lt; -0.5dB<ul><li>if not at max power (see <em>note 1</em>); <code>txPower++</code></li><li>else if not at min MCS; MCS to next lower value (see <em>note 2</em>)</li><li>if MCS or power changed, <code>offset = 0</code></li></ul></li><li>else if offset &gt; +1.0dB<ul><li>if there is enough headroom to increase power and MCS, then do both</li><li>else if there is room to lower power, then lower power</li><li>if MCS or power changed, <code>offset = 0</code></li></ul></li></ul><p>Notes:</p><ol><li>The maximum power is the minimum of the global txMaxPower and the
max power per MCS (both configurable).</li><li>LA/TPC skips MCS5 because MCS6 is a higher rate and lower SNR.</li></ol><p align="center"><img loading="lazy" src="/figures/latpc_waterfill.svg" width="620" class="img_ev3q"></p><p>When the offset is good, the algorithm increases both power and MCS at the same
time. The reason is that a transition from <code>MCS(n)</code> to <code>MCS(n+1)</code> requires a
power increase that depends on <code>n</code>. The amount
of power increase is determined by the difference in SNR in the MCS table
between <code>MCS(n)</code> and <code>MCS(n+1)</code> and depends on the transmit power table.
If the calculated power increase pushes the power above the
configured maximum, then LA/TPC will reduce power by one index instead of
increasing MCS and power. It will continue to reduce power until there is enough
headroom to increase both power and MCS.</p><p>In this case where the offset is good, Δ = <code>MCS(n+1) - MCS(n)</code>.  The power index
continues to increase while the change in power is less than Δ and while
it is less than the maximum allowed power.  For example,
assuming that every transmit power index change corresponds to 0.5dB and if
Δ = 1.5dB, then the power will increase 2 indices.
If Δ = 1.75dB, the power would increase by 3 indices.</p><p>During a transition from no-traffic mode to traffic mode, MCS can increase
without increasing power. This prevents a ramp in power every time we transition
from no-traffic to traffic modes. MCS will continue to increase until the offset
crosses the negative threshold at which point the algorithm returns to the
normal mode described above.</p><p>When the offset is bad, the algorithm is simpler - it will reduce the power
until it hits the limit then it will reduce the MCS.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="latpc-configuration">LA/TPC Configuration<a class="hash-link" href="#latpc-configuration" title="Direct link to heading">​</a></h3><p>LA is enabled if the <code>mcs</code> configuration value is 35, with lower and upper
bounds set to <code>laMinMcs</code> and <code>laMaxMcs</code> respectively. Setting any other valid
<code>mcs</code> value disables LA and freezes the MCS at the given value.</p><p>TPC is enabled if the <code>tpcEnable</code> configuration value is 3, with lower and upper
bounds set at <code>minTxPower</code> and <code>maxTxPower</code> respectively. Initializing
<code>tpcEnable</code> to 0 disables TPC and freezes the transmit power at the <code>txPower</code>
value. If <code>tpcEnable</code> is disabled during runtime, the power will be fixed at the
current value instead.</p><p>The <code>txPower</code> value is an index between 0 and 31. The TPC algorithm expects that
the actual transmit power will monotonically increase as the index increases,
and also expects approximately 1dB of increase per index (but this need not be
precise). The actual power will depend on the number of antenna arrays and is
vendor-specific.</p><p>The MCS table is configurable at both initialization time and during runtime
(all links use the same MCS table in P2MP). At initialization time, it is
configurable using the 4 parameters <code>mcsLqmQ3_1_4</code>, <code>mcsLqmQ3_5_8</code>,
<code>mcsLqmQ3_9_12</code>, and <code>mcsLqmQ3_13_16</code> corresponding to MCS 1-4, 5-8, 9-12, and
13-16 (EDMG only). Each parameter has 4 MCS SNR values packed in Q3 format
(times 2^3), 8 bits per value. For example, the SNR corresponding to MCS2 is
<code>(mcsLqmQ3_1_4 &gt;&gt; 8) &amp; 0xff</code>. There is a MATLAB script in the <code>utils</code> directory
(<code>fw_cfg_mcs_table.m</code>) that will convert the MCS table into this packed
notation. The MATLAB also contains code to convert the packed notation back into
unpacked.</p><p>To configure the MCS table at runtime, issue the r2d2 command below:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ r2d2 phyla_config -m </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">peer MAC addr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -f /path/to/fw_phyla_cfg.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There is an example of this file in <code>/etc/e2e_config/fw_phyla_cfg.json</code>. Runtime
configuration is only for debugging (it is not supported from the E2E).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bler-to-per">BLER to PER<a class="hash-link" href="#bler-to-per" title="Direct link to heading">​</a></h3><p>When there is data traffic, LA/TPC is driven by the LDPC block error rate (BLER)
as reported in the block acks. The LDPC BLER is:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nSyn/nCW</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where nSyn is the number of syndromes and nCW the number of LDPC codewords.
The packet error rate (PER) is estimated from the BLER as:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PER ~= BLER2PER_factor * nSyn/nCW</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have found through experimentation that BLER2PER_factor is approximately 30.
Occasionally, there can be short (~10ms) periods of PER that are not caused by
the channel. To reduce sensitivity, BLER2PER_factor includes an exponential ramp
that increases by a factor of 2 for every SF with BLER &gt; 0 up to an upper limit.
When the BLER is 0, BLER2PER_factor is set to a lower limit. An exception is
immediately after a change in power or MCS - in this case, BLER2PER_factor is
set to the upper limit to react quickly to errors caused by MCS/power changes.</p><p>The lower and upper limits are configurable using <code>latpcBlerToPer</code> as follows:</p><table><thead><tr><th>Bit Mask</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td>bits 3:0</td><td>Lower limit = 2^n for n = bits 3:0</td><td>1 (lower limit = 2)</td></tr><tr><td>bits 7:4</td><td>Upper limit = 2^n for n = bits 7:4</td><td>5 (upper limit = 32)</td></tr></tbody></table><p>The overall default for <code>latpcBlerToPer</code> is therefore 81 or 0x51.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="setting-maximum-transmit-power-per-mcs">Setting Maximum Transmit Power Per MCS<a class="hash-link" href="#setting-maximum-transmit-power-per-mcs" title="Direct link to heading">​</a></h3><p>To handle non-linear distortion at high power, it is possible to limit the
maximum transmit power per MCS at high transmit powers. Without this capability,
the algorithm would always assume that higher power is better and increase the
transmit power when there are errors. Setting the maximum power per MCS informs
the algorithm that when it increases the transmit power, it may also need to
lower the MCS.</p><p>The maximum transmit power per MCS is determined by the configuration values
<code>maxTxPowerPerMcs</code> and <code>maxTxPowerPerMcsEdmg</code> (for EDMG only). MCS values are
divided into the following ranges/values:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[1-9, 10, 11, 12, 13, 14, 15, 16]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The maximum power can be set independently for each of these ranges/values, with
a hard upper limit of <code>maxTxPower</code> (the global limit).</p><p><code>maxTxPowerPerMcs</code> is a 4-byte number, where each byte represents the maximum
power for an MCS range/value. The least significant byte (LSB) corresponds to
the first range/value (i.e. MCS 1-9). For example:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">maxTxPowerPerMcs = 0x1115181c (hex) or 286595100 (dec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- max power for MCS  [12] = 0x11 (hex) or 17 (dec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- max power for MCS  [11] = 0x15 (hex) or 21 (dec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- max power for MCS  [10] = 0x18 (hex) or 24 (dec)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- max power for MCS [1-9] = 0x1c (hex) or 28 (dec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>maxTxPowerPerMcsEdmg</code> extends the configuration to MCS 13, 14, 15, and 16. The
LSB corresponds to MCS 13. This value only takes effect when <code>cb2Enable</code> is set,
which enables the EDMG MCS levels.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-traffic-vs-no-data-traffic">Data Traffic vs. No Data Traffic<a class="hash-link" href="#data-traffic-vs-no-data-traffic" title="Direct link to heading">​</a></h3><p>LA/TPC is normally driven by the packet error rate (PER). When there is very
little or no data traffic, the PER cannot be measured, and SNR is used instead
until data traffic is detected again.</p><p>If there is no data traffic for 125 consecutive superframes (200ms), the
algorithm switches to the &quot;no data traffic&quot; mode. In this mode, the maximum MCS
temporarily changes from <code>laMaxMcs</code> to <code>noTrafficMaxMcsFallback</code> (default 9 for
DMG and 10 for EDMG). Note that it can take a couple of seconds for the MCS to
recover (e.g. to MCS 12 if the fallback is 9).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="per-target">PER Target<a class="hash-link" href="#per-target" title="Direct link to heading">​</a></h3><p>As mentioned above, LA/TPC is normally driven by PER. The PER is the receiver
LDPC-derived PER, which is fed back to the transmitter.</p><p>The algorithm attempts to stabilize at a PER target, defined as the inverse of
<code>laInvPERTarget</code>. The default value of <code>laInvPERTarget</code> is 200, making the PER
target 0.005 (or 0.5%). This is a rough, long-term target.</p><p>If the current PER is above the target, the algorithm will generally increase
the power or lower the MCS. If the PER is below the target, the algorithm will
generally, and more slowly, increase the MCS or lower the power.</p><p>The speed at which the algorithm reacts is governed by
<code>laConvergenceFactordBperSFQ8</code>. Changing this value is not recommended.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="100-per-condition">100% PER Condition<a class="hash-link" href="#100-per-condition" title="Direct link to heading">​</a></h3><p>LA/TPC is driven by LDPC feedback when there is traffic.  When there is 100% PER
for an entire PPDU, there might be no LDPC feedback and the transmit counters
(txOk/txFail) indicate 100% PER. When this happens, the LA/TPC offset is reduced
by 0.4dB (configurable, see below).</p><p>Reasons for 100% can include early-weak interference causing a missed PPDU or a
missed block-ack, a calibration event, or can mean that none of the MDPUs were
decoded because of low SNR.  In the case of calibration, we don&#x27;t want to adapt
the MCS or power.  The case of early-weak interference is more complicated;
lowering MCS will not help but increasing the power can. In the low SNR case, we
do want to adapt the MCS and/or power.</p><p>There is no way to know what causes 100% PER.  We assume that calibration
superframes are always isolated meaning that there are always several
non-calibration superframes between calibration superframes. Therefore, for each
link, LA/TPC will wait for two (configurable) or more data-carrying superframes
with 100% PER in a row before reacting.  In that case, we want the offset
reduction to be 0.8dB when two superframes of 100% are first detected. After
then, the offset should return to 0.4dB.</p><p>The 100% PER algorithm can also disable TPC to prevent a power ramp when
<code>peer SNR &gt; mcsTable[MCS]</code> where <code>mcsTable[]</code> is a static table of SNR values to
support a given MCS. But as mentioned earlier, this could affect early-weak
interference performance.</p><p>The LA/TPC offset reduction is now configurable (0.4dB is the default). The
number of consecutive superframes of 100% PER is configurable (default is 2; set
to 1 for no filtering). The feature that disables TPC can also be disabled.
Configuration uses bits in <code>latpc100PercentPERDrop</code> according to the table
below.</p><table><thead><tr><th>Bit Mask</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td>bits 3:0</td><td>Offset reduction = 0.4dB * (value) / 4</td><td>4</td></tr><tr><td>bit 4</td><td>TPC disable feature (1 to allow TPC disable, 0 to not disable TPC)</td><td>1</td></tr><tr><td>bits 10:8</td><td>Number of consecutive superframes with data</td><td>2</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fast-link-impairment-detection">Fast Link Impairment Detection<a class="hash-link" href="#fast-link-impairment-detection" title="Direct link to heading">​</a></h2><p>To enable fast re-routing, the firmware monitors link conditions and signals
link impairment to routing protocols when a link is impaired. The goal is to
report link impairment in under 50ms. When a link is impaired, the routing
protocol will not use the link, and will re-route traffic if another path is
available.</p><p>The Terragraph wireless link remains up as long as MCS 0 management messages are
successfully exchanged. Data traffic uses MCS &gt;= 1, which requires around
12dB higher signal-to-noise ratio (SNR) than the management messages. This
means that the link can be up but unable to pass traffic. When this happens,
the link state changes from <code>LINK_UP</code> to <code>LINK_UP_DATADOWN</code>.</p><p>When <code>numOfHbLossToFail</code> (default 10) management messages are missed, the link
will go down (<code>LINK_DOWN</code>). Fast link impairment is designed to indicate a
failure more quickly than <code>LINK_DOWN</code>.</p><p>The <code>LINK_UP_DATADOWN</code> state persists for at least 200 superframes (320ms), or
longer if the impairment condition continues.</p><p>It is possible that link impairment is detected at only one side of a link (e.g.
if interference is present). A management message is exchanged such that if one
side enters <code>LINK_UP_DATADOWN</code>, both sides will enter <code>LINK_UP_DATADOWN</code>. This
prevents routing traffic over the link in a single direction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="conditions-for-link-impairment">Conditions for Link Impairment<a class="hash-link" href="#conditions-for-link-impairment" title="Direct link to heading">​</a></h3><p>At a high level, the algorithm monitors link conditions, PER, and management
messages, switching to <code>LINK_UP_DATADOWN</code> upon seeing any of the following
conditions:</p><ul><li>A small number of management messages are missed and PER is at 100%.</li><li>LA/TPC wants to reduce MCS or increase power, but MCS/power are already at the
minimum/maximum (respectively).</li><li>Many management messages are missed (but fewer than <code>numOfHbLossToFail</code>).</li></ul><p>Specifically, link impairment is detected using the following condition:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(100%PER &amp;&amp; (missedHB || SNRlow || farEndSNRlow))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  || MCS@limit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  || missedManyHB</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Each sub-condition is described below:</p><ul><li><code>100%PER</code>: 100% <code>txPER</code> (use ACK/NACK count) as measured at the transmitter.
The condition is that there is a time window with 4 (default, configurable)
superframes with 100% PER and traffic.  The time window is reset
if there is a superframe with traffic and PER &lt; 100%.</li><li><code>missedHB</code>: 3 (default, configurable) missed received HB/KA/ULBWREQs in a row.</li><li><code>SNRlow</code>: SNR measured on HB/KA/ULBWREQ &lt; 2dB (if received). Previous studies
showed that even with a bus or truck, sometimes heartbeats can get through.</li><li><code>farEndSNRlow</code>: Peer SNR reported in HB/KA/ULBWREQ &lt; 2dB (as reported through
HB/KA/ULBWREQ), for the same reason as <code>SNRlow</code>.</li><li><code>MCS@limit</code>: If, in any one superframe, the LA/TPC algorithm wants to
increase power or decrease MCS but is at the limit, <code>MCS@limitSF</code> is set.
The condition for <code>MCS@limit</code> is that there is a time window with 4
(default, configurable) superframes with <code>MCS@limitSF</code> and traffic.
A superframe in which <code>MCS@limitSF</code> is not set resets the window.</li><li><code>missedManyHB</code>: Missed 5 (default, configurable) HB/KA/ULBWREQ messages in a
row. This covers the case of no traffic and truck blockage.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-parameters">Configuration Parameters<a class="hash-link" href="#configuration-parameters" title="Direct link to heading">​</a></h4><p>There are four configurable threshold parameters for detecting link impairment.
They are encoded in the 32-bit latpcLinkImpairConfig as part of the link
configuration. These parameters can be set per link.</p><p>The condition for all thresholds is that the condition <strong>&gt;=</strong> threshold;
if the threshold is zero, the condition will always be true.</p><table><thead><tr><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td><code>100PER</code> (bits 3:0)</td><td>See <code>100%PER</code> above. Set to 0xf to disable <code>100%PER</code></td></tr><tr><td><code>missedCnt</code> (bits 7:4)</td><td>See <code>missedHB</code> above. Set to 0xf to disable <code>missedHB</code></td></tr><tr><td><code>missedManyCnt</code> (bits 11:8)</td><td>See <code>missedManyHB</code> above. Set to 0xf to disable <code>missedManyHB</code></td></tr><tr><td><code>MCSlimit</code> (bits 15:12)</td><td>See <code>MCS@limit</code> above. Set to 0xf to disable <code>MCS@limit</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debouncing">Debouncing<a class="hash-link" href="#debouncing" title="Direct link to heading">​</a></h3><p>Debouncing is implemented to prevent rapid transitions between <code>LINK_UP</code> and
<code>LINK_UP_DATADOWN</code>. This uses a state machine with states, transition events,
and times shown in the figure below.</p><p align="center"><img loading="lazy" src="/figures/fast_link_impairment.svg" width="620" class="img_ev3q"></p><p>The normal state is <code>TG_LINK_IMPAIRMENT_LINK_UP</code>. If the firmware detects link
impairment, it transitions to <code>TG_LINK_IMPAIRMENT_LINK_DOWN</code> and sends an event
to the TG state machine to transition to <code>LINK_UP_DATADOWN</code>. If there is an
<code>LSM_EVE_LINK_DATAUP</code> event, the TG state machine will transition back to
<code>LINK_UP</code>. All timeouts are in units of superframes (1.6ms). As mentioned
earlier, &quot;peer link impaired&quot; means that the other end of the link detected link
impairment and reported it via a management message.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-link-impairment">Monitoring Link Impairment<a class="hash-link" href="#monitoring-link-impairment" title="Direct link to heading">​</a></h3><p>Two relevant counters (stats) are reported by the firmware every second:</p><ul><li><code>staPkt.mgmtLinkUp</code> - Increments every BWGD when the link is in <code>LINK_UP</code> or
<code>LINK_UP_DATADOWN</code>.</li><li><code>staPkt.linkAvailable</code> - Increments every BWGD when the link is in <code>LINK_UP</code>
only.</li></ul><p>If the difference between these two stats increases, then the link entered
<code>LINK_UP_DATADOWN</code>. The change in the difference between the two stats indicates
how long it was in the <code>LINK_UP_DATADOWN</code> state, in units of BWGDs (25.6ms).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/terragraph/meta-terragraph/edit/main/docs/../docs/developer/PHY_Algorithms.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developer/MAC_PHY_Specification"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">MAC &amp; PHY Specification</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/developer/Firmware_Stats"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Firmware Stats</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#maximum-agc--minimum-rssi" class="table-of-contents__link toc-highlight">Maximum AGC &amp; Minimum RSSI</a><ul><li><a href="#algorithm-description" class="table-of-contents__link toc-highlight">Algorithm Description</a></li><li><a href="#calculating-gains" class="table-of-contents__link toc-highlight">Calculating Gains</a></li><li><a href="#p2mp" class="table-of-contents__link toc-highlight">P2MP</a></li><li><a href="#rf-gain-hilo" class="table-of-contents__link toc-highlight">RF Gain Hi/Lo</a></li><li><a href="#configuration-options" class="table-of-contents__link toc-highlight">Configuration Options</a></li><li><a href="#dynamic-agc-configuration" class="table-of-contents__link toc-highlight">Dynamic AGC Configuration</a></li></ul></li><li><a href="#link-adaptation-and-transmit-power-control-latpc" class="table-of-contents__link toc-highlight">Link Adaptation and Transmit Power Control (LA/TPC)</a><ul><li><a href="#traffic-driven-mode" class="table-of-contents__link toc-highlight">Traffic-Driven Mode</a></li><li><a href="#no-traffic-mode" class="table-of-contents__link toc-highlight">No-Traffic Mode</a></li><li><a href="#core-algorithm" class="table-of-contents__link toc-highlight">Core Algorithm</a></li><li><a href="#latpc-configuration" class="table-of-contents__link toc-highlight">LA/TPC Configuration</a></li><li><a href="#bler-to-per" class="table-of-contents__link toc-highlight">BLER to PER</a></li><li><a href="#setting-maximum-transmit-power-per-mcs" class="table-of-contents__link toc-highlight">Setting Maximum Transmit Power Per MCS</a></li><li><a href="#data-traffic-vs-no-data-traffic" class="table-of-contents__link toc-highlight">Data Traffic vs. No Data Traffic</a></li><li><a href="#per-target" class="table-of-contents__link toc-highlight">PER Target</a></li><li><a href="#100-per-condition" class="table-of-contents__link toc-highlight">100% PER Condition</a></li></ul></li><li><a href="#fast-link-impairment-detection" class="table-of-contents__link toc-highlight">Fast Link Impairment Detection</a><ul><li><a href="#conditions-for-link-impairment" class="table-of-contents__link toc-highlight">Conditions for Link Impairment</a></li><li><a href="#debouncing" class="table-of-contents__link toc-highlight">Debouncing</a></li><li><a href="#monitoring-link-impairment" class="table-of-contents__link toc-highlight">Monitoring Link Impairment</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Terragraph</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/runbook/Overview">Overview</a></li><li class="footer__item"><a href="https://www.facebook.com/connectivity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meta Connectivity<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/terragraph" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/HQaxCevzus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ee1b3ecd.js"></script>
<script src="/assets/js/main.feb34f19.js"></script>
</body>
</html>