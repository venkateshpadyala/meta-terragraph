"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3019],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),m=r,h=u["".concat(s,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5650:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={},o="Monitoring and Alerting",l={unversionedId:"runbook/Monitoring",id:"runbook/Monitoring",title:"Monitoring and Alerting",description:"This document describes Terragraph's management software for network monitoring",source:"@site/../docs/runbook/Monitoring.md",sourceDirName:"runbook",slug:"/runbook/Monitoring",permalink:"/docs/runbook/Monitoring",draft:!1,editUrl:"https://github.com/terragraph/meta-terragraph/edit/main/docs/../docs/runbook/Monitoring.md",tags:[],version:"current",frontMatter:{},sidebar:"runbookSidebar",previous:{title:"Maintenance and Configuration",permalink:"/docs/runbook/Maintenance"},next:{title:"Routing and Traffic Engineering",permalink:"/docs/runbook/Routing"}},s={},p=[{value:"Network Management System (NMS)",id:"network-management-system-nms",level:2},{value:"UI Overview",id:"ui-overview",level:3},{value:"NMS Configuration",id:"nms-configuration",level:4},{value:"Map View",id:"map-view",level:4},{value:"Map Layers",id:"map-layers",level:5},{value:"Editing",id:"editing",level:5},{value:"Add Site",id:"add-site",level:6},{value:"Add Node",id:"add-node",level:6},{value:"Add Link",id:"add-link",level:6},{value:"Stats / Dashboard",id:"stats--dashboard",level:4},{value:"Aggregated Stats",id:"aggregated-stats",level:5},{value:"Link Availability",id:"link-availability",level:6},{value:"Topology Stats",id:"topology-stats",level:6},{value:"Troubleshooting Missing Data",id:"troubleshooting-missing-data",level:5},{value:"Kafka",id:"kafka",level:6},{value:"NMS Aggregator",id:"nms-aggregator",level:6},{value:"Software Upgrades",id:"software-upgrades",level:4},{value:"Configuration Management",id:"configuration-management",level:4},{value:"Troubleshooting",id:"troubleshooting",level:4},{value:"API Service",id:"api-service",level:2},{value:"Components",id:"components",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Installation",id:"installation",level:3},{value:"Documentation",id:"documentation",level:3},{value:"SNMP",id:"snmp",level:2},{value:"Basic Configuration",id:"basic-configuration",level:3},{value:"Access Configuration Examples",id:"access-configuration-examples",level:3},{value:"SNMP V2C (Community)",id:"snmp-v2c-community",level:4},{value:"SNMP V3 Authentication Without Privacy (Encryption)",id:"snmp-v3-authentication-without-privacy-encryption",level:4},{value:"SNMP V3 Authentication With Privacy (Encryption)",id:"snmp-v3-authentication-with-privacy-encryption",level:4},{value:"UDP Pinger",id:"udp-pinger",level:2}],d={toc:p};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"monitoring-and-alerting"},"Monitoring and Alerting"),(0,r.kt)("p",null,"This document describes Terragraph's management software for network monitoring\nand alerting."),(0,r.kt)("a",{id:"monitoring-nms"}),(0,r.kt)("h2",{id:"network-management-system-nms"},"Network Management System (NMS)"),(0,r.kt)("p",null,"The Terragraph NMS is designed to help operators and developers manage their\nnetwork. Nearly all operations in the NMS are commands sent directly to an E2E\ncontroller. The NMS can connect to multiple E2E controllers, serving as a\ncentral platform for managing several Terragraph networks."),(0,r.kt)("h3",{id:"ui-overview"},"UI Overview"),(0,r.kt)("h4",{id:"nms-configuration"},"NMS Configuration"),(0,r.kt)("p",null,"The NMS must be configured to communicate with one or more E2E controllers via\ntheir respective ",(0,r.kt)("a",{parentName:"p",href:"#monitoring-api"},"API service"),' processes. These "networks" can\nbe added and managed on the ',(0,r.kt)("strong",{parentName:"p"},"NMS Config")," page."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/nms_config.png",width:"1000"})),(0,r.kt)("p",null,"To add a new network, click ",(0,r.kt)("strong",{parentName:"p"},"Create Network")," at the top of the page. Give a\nname for the network, and enter the IP address of the controller and the ports\nfor the E2E controller and API service processes (if not using the defaults)."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/nms_config_form.png",width:"512"})),(0,r.kt)("h4",{id:"map-view"},"Map View"),(0,r.kt)("p",null,"The map view shows the state of the E2E controller and Query Service, and the\nstatus of the network according to E2E controller."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/map_main.jpg",width:"1000"})),(0,r.kt)("p",null,"To view details about a specific sector, link, or site, select it on the map."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/map_node_details.jpg",width:"1000"})),(0,r.kt)("p",null,"Additional sector and link details can be found in the table view. These tables\ncan be overlaid on the map by clicking on the table icon on the bottom-left."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/map_with_tables.jpg",width:"1000"})),(0,r.kt)("h5",{id:"map-layers"},"Map Layers"),(0,r.kt)("p",null,'Many map features can be adjusted in the "Map Layers" panel:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Layers")," - Show or hide layers of the map, such as site name labels and 3D\nbuildings."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Link Lines Overlay")," - Use lines to show link health, configuration\n(i.e. Golay index), or metrics (e.g. SNR, MCS, link utilization)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Site Icons Overlay")," - Use site icons to show sector health or configuration\n(i.e. polarity)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Map Style")," - Change the map tiles (e.g. street view, satellite view, dark\nmode).")),(0,r.kt)("p",null,'By default, the "Health" view of the network is shown on the map. The meaning of\nthe site and link colors is as follows:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Site Health",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Green")," - All sectors/radios defined for the site are reporting to E2E\ncontroller."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Red")," - No sectors/radios are reporting, but there is at least one\ndefined."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Orange")," - There are both online and offline sectors/radios present on\nthe site."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"White")," - No sectors/radios are defined."))),(0,r.kt)("li",{parentName:"ul"},"Link Health",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Green")," - The link initiating sector has reported successful link\nignition. This does not signify that the remote sector is reachable, as\nthere could still be routing issues preventing the remote sector from\ncommunicating with the controller."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Purple")," - The E2E controller is attempting to bring this link online\n(i.e. currently an ignition candidate)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Red")," - The link is offline, and not a current ignition candidate.")))),(0,r.kt)("p",null,"Below is an example highlighting site polarities and SNR levels across each\nlink:"),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/map_overlays.jpg"})),(0,r.kt)("a",{id:"monitoring-map-editing"}),(0,r.kt)("h5",{id:"editing"},"Editing"),(0,r.kt)("p",null,'New sites, sectors, and links can be added to the topology once the E2E\ncontroller is online by clicking the "+" button on the bottom-right.'),(0,r.kt)("h6",{id:"add-site"},"Add Site"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose ",(0,r.kt)("strong",{parentName:"p"},"Add Planned Site")," from the menu.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Either drag the site into place or manually enter the coordinates. Click\n",(0,r.kt)("strong",{parentName:"p"},"Add Site")," when finished."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/planned_site.jpg",width:"1000"})))),(0,r.kt)("h6",{id:"add-node"},"Add Node"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose ",(0,r.kt)("strong",{parentName:"p"},"Add Node")," from the menu.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Enter all available information for the new sector/node. Some fields can be\nleft blank."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/add_node.png",width:"240"})))),(0,r.kt)("h6",{id:"add-link"},"Add Link"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose ",(0,r.kt)("strong",{parentName:"p"},"Add Link")," from the menu.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the node endpoints (in any order)."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/add_link.png",width:"240"})))),(0,r.kt)("h4",{id:"stats--dashboard"},"Stats / Dashboard"),(0,r.kt)("p",null,"The NMS back-end currently stores about 3 days worth of statistics at a 30\nsecond resolution. In the future, support will be added for multiple resolution\nintervals to allow showing long-term trending and higher-frequency debug data."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the ",(0,r.kt)("strong",{parentName:"p"},"Stats")," icon on the left-hand toolbar.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Enter the key name for the stat. Link key names include the destination MAC\naddress, which would be tedious to look up for each link. Common key names\nare aliased with short names, such as "snr" and "mcs", which are translated\non the back-end into the full key name on both sides of the link. For\ninstance, "snr" translates to ',(0,r.kt)("inlineCode",{parentName:"p"},"tgf.<mac_addr>.phystatus.ssnrEst")," for the A\nand Z endpoints of a link."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/stats_typeahead_snr.png",width:"300"}))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select one or more keys from the type-ahead."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/stats_snr_rssi.png",width:"1000"})))),(0,r.kt)("h5",{id:"aggregated-stats"},"Aggregated Stats"),(0,r.kt)("h6",{id:"link-availability"},"Link Availability"),(0,r.kt)("p",null,"The link availability metrics are based on the link keep-alive counts for every\ndefined wireless link. Each time a link misses too many heartbeats, it is marked\nas offline. The one-day availability metric is computed from the last 24 hours\nof keep-alive metrics on both sides of each link, and the overall network\navailability is an average across all defined links. Note that when a new link\nis added, its availability will be 0% and skew the average. In the future, more\nflexibility will be added in this high-level metric."),(0,r.kt)("h6",{id:"topology-stats"},"Topology Stats"),(0,r.kt)("p",null,"Basic statistics about the network topology are recorded within Query Service,\nwhich requires configuring Query Service to point to the correct API service.\nThis is not yet configurable through the Docker installation."),(0,r.kt)("h5",{id:"troubleshooting-missing-data"},"Troubleshooting Missing Data"),(0,r.kt)("p",null,"The sections below describe troubleshooting missing data in different storage\nengines."),(0,r.kt)("h6",{id:"kafka"},"Kafka"),(0,r.kt)("p",null,"Node statistics generally exhibit a few seconds of delay before they are\navailable in Prometheus/Grafana. If stats are missing, please follow the\ntroubleshooting steps below:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Stats agent must be configured to push to Kafka via ",(0,r.kt)("inlineCode",{parentName:"li"},"brokerEndpointList"),". See\n",(0,r.kt)("a",{parentName:"li",href:"/docs/runbook/Deployment#deployment-kafka-configuration"},"Kafka Configuration")," for\ninstructions on configuration."),(0,r.kt)("li",{parentName:"ul"},"Prometheus, Prometheus Cache, and Query Service must be running.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker service ps stats_prometheus stats_prometheus_cache stats_query_service\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Verify Kafka is receiving node stats by consuming the ",(0,r.kt)("inlineCode",{parentName:"li"},"stats")," topic from any\nDocker Swarm node. If no stats are shown, verify the Kafka configuration\nis correct and the nodes are able to reach the Kafka endpoint.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker exec -it \\\n  $(docker ps --filter='label=com.docker.swarm.service.name=kafka_kafka' --format='{{.ID}}') \\\n  /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server kafka:9092 --topic stats\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check Query Service logs for errors.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker service logs stats_query_service -f\n")),(0,r.kt)("h6",{id:"nms-aggregator"},"NMS Aggregator"),(0,r.kt)("p",null,"Node statistics are published to NMS Aggregator via a ZMQ socket from\nstats agent running on each node. NMS Aggregator must be configured to publish\nits metrics to a URL that can store the time-series data."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Ensure the aggregator URL is set via ",(0,r.kt)("inlineCode",{parentName:"li"},"kvstoreParams.e2e-aggr-url")," in the PoP\nnode configuration. See ",(0,r.kt)("a",{parentName:"li",href:"/docs/runbook/Quick_Start#pop-node-config-1"},"PoP Node Config"),"\nfor instructions on configuration."),(0,r.kt)("li",{parentName:"ul"},"Ensure NMS aggregator is configured to publish to an HTTP endpoint via\n",(0,r.kt)("inlineCode",{parentName:"li"},"dataEndpoints.nms.host"),".")),(0,r.kt)("h4",{id:"software-upgrades"},"Software Upgrades"),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/docs/runbook/Maintenance#maintenance-upgrades"},"Maintenance and Configuration")," for\ninstructions on performing software upgrades on Terragraph nodes."),(0,r.kt)("h4",{id:"configuration-management"},"Configuration Management"),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/docs/runbook/Maintenance#maintenance-config"},"Maintenance and Configuration")," for\ninstructions on viewing and editing node configuration and E2E configuration."),(0,r.kt)("h4",{id:"troubleshooting"},"Troubleshooting"),(0,r.kt)("p",null,"If either the E2E controller or Query Service is offline, follow these\ntroubleshooting steps:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"E2E")," - Check the configuration above and ensure that the Docker instance\ncan access the E2E controller on port 17077 (the default E2E controller port\nfor applications)."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Stats")," - Ensure that the ",(0,r.kt)("strong",{parentName:"li"},"Query Service")," is running. Check the NMS logs\nfor any obvious errors.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ docker logs terragraph_nms_1 -f\n")),(0,r.kt)("a",{id:"monitoring-api"}),(0,r.kt)("h2",{id:"api-service"},"API Service"),(0,r.kt)("p",null,"The API Service provides an abstraction layer over Terragraph's communication\nprotocols, and serves as the integration point for external software systems.\nThe service provides a REST API that enables most of the functionality within\nthe E2E controller and NMS aggregator. Requests are translated into the\nasynchronous, Thrift-serialized ZeroMQ messages used within Terragraph;\nresponses are returned in plain JSON."),(0,r.kt)("h3",{id:"components"},"Components"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("a",{parentName:"strong",href:"https://github.com/facebook/proxygen"},"Proxygen"))," - HTTP server, created and open-sourced by Meta."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("a",{parentName:"strong",href:"http://apidocjs.com/"},"apiDoc"))," - API documentation generator from annotations in source code.")),(0,r.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"The API service requires connectivity to an E2E controller and NMS aggregator\nfor all functionality."),(0,r.kt)("h3",{id:"installation"},"Installation"),(0,r.kt)("p",null,"The API service is included as part of the same E2E image that contains the\ncontroller and aggregator."),(0,r.kt)("h3",{id:"documentation"},"Documentation"),(0,r.kt)("p",null,"The REST API documentation is statically hosted by the API service at the\n",(0,r.kt)("inlineCode",{parentName:"p"},"/docs/")," endpoint. For example (assuming the API service is running on\n172.17.0.1, port 8088):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"http://172.17.0.1:8088/docs/\n")),(0,r.kt)("p",null,"Within the E2E image, the directory containing the HTML documentation is ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/apidoc/"),"."),(0,r.kt)("h2",{id:"snmp"},"SNMP"),(0,r.kt)("p",null,"Each node runs a ",(0,r.kt)("a",{parentName:"p",href:"http://www.net-snmp.org/"},"Net-SNMP")," (Simple Network Management Protocol) daemon\nalongside the Terragraph SNMP agent which can be polled for statistics.\nThe SNMP agent registers ",(0,r.kt)("inlineCode",{parentName:"p"},"TERRAGRAPH-RADIO-MIB")," to handle all requests\nfor the MIB (Management Information Base)."),(0,r.kt)("h3",{id:"basic-configuration"},"Basic Configuration"),(0,r.kt)("p",null,"SNMP is disabled by default via ",(0,r.kt)("inlineCode",{parentName:"p"},"envParams.SNMP_ENABLED"),". Once enabled,\nconfiguration must be specified for SNMP V2C (community) or V3 access."),(0,r.kt)("p",null,"An example base configuration without access rules is shown below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "envParams": {\n    "SNMP_ENABLED": "1"\n  },\n  "snmpConfig": {\n    "contact": "Contact name",\n    "location": "State, Country",\n    ...\n  }\n}\n')),(0,r.kt)("h3",{id:"access-configuration-examples"},"Access Configuration Examples"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"TERRAGRAPH-RADIO-MIB")," must be configured in the SNMP client to decode the\ndata from the SNMP daemon. The MIB for Terragraph radio stats is located in\n",(0,r.kt)("inlineCode",{parentName:"p"},"src/terragraph-stats/src/mib"),"."),(0,r.kt)("h4",{id:"snmp-v2c-community"},"SNMP V2C (Community)"),(0,r.kt)("p",null,"Configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"snmpV2C": {\n  "nameOrDescription": {\n    "community": "public"\n  }\n}\n')),(0,r.kt)("p",null,"Client request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"snmpbulkwalk -v 2c -c public <HOST> TERRAGRAPH-RADIO-MIB::tgRadioInterfacesTable\n")),(0,r.kt)("h4",{id:"snmp-v3-authentication-without-privacy-encryption"},"SNMP V3 Authentication Without Privacy (Encryption)"),(0,r.kt)("p",null,"Configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"snmpV3": {\n  "nameOrDescription": {\n    "authPassphrase": "MyPassword",\n    "authType": "MD5",\n    "username": "tg"\n  }\n}\n')),(0,r.kt)("p",null,"Client request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"snmpbulkwalk -v 3 -l authNoPriv -a MD5 -u tg -A MyPassword <HOST> \\\n  TERRAGRAPH-RADIO-MIB::tgRadioInterfacesTable\n")),(0,r.kt)("h4",{id:"snmp-v3-authentication-with-privacy-encryption"},"SNMP V3 Authentication With Privacy (Encryption)"),(0,r.kt)("p",null,"Configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"snmpV3": {\n  "nameOrDescription": {\n    "authPassphrase": "MyPassword",\n    "authType": "MD5",\n    "privProtocol": "DES",\n    "privPassphrase": "MyPrivacyPassword",\n    "username": "tg"\n  }\n}\n')),(0,r.kt)("p",null,"Client request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"snmpbulkwalk -v 3 -l authPriv -a MD5 -u tg -A MyPassword -x DES \\\n  -X MyPrivacyPassword <HOST> TERRAGRAPH-RADIO-MIB::tgRadioInterfacesTable\n")),(0,r.kt)("h2",{id:"udp-pinger"},"UDP Pinger"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"udp_pinger")," is a service that runs in the Terragraph cloud suite. The\nprimary goal of this service is to periodically send UDP probes to all of the\nnodes in each network managed by the NMS. Nodes run an ",(0,r.kt)("inlineCode",{parentName:"p"},"sv")," process called\n",(0,r.kt)("inlineCode",{parentName:"p"},"udp_ping_server")," that listens on port 31338 for the probes."),(0,r.kt)("p",null,"By default, the ",(0,r.kt)("inlineCode",{parentName:"p"},"udp_pinger")," sends ten probes every ten seconds at a rate of\nfive probes per second. Any responses that do not come back within one second\nare dropped and assumed to be lost. All of these parameters are configurable."),(0,r.kt)("p",null,"At the end of each ping interval, the service computes the following metrics\nfor each node and across the entire network. Each metric is published to\nPrometheus to be displayed in Grafana or later read/consumed by another\nservice."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"udp_pinger_loss_ratio")),(0,r.kt)("td",{parentName:"tr",align:null},"The percentage of packets that were lost in the given ping interval")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"udp_pinger_rtt_avg")),(0,r.kt)("td",{parentName:"tr",align:null},"The average round-trip time (RTT) for all the packets that successfully returned in the interval")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"udp_pinger_rtt_max")),(0,r.kt)("td",{parentName:"tr",align:null},"The maximum RTT of all the packets that returned succesfully in the interval")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"udp_pinger_rtt_p75")),(0,r.kt)("td",{parentName:"tr",align:null},"The P75 RTT of all the packets that returned successfully in the interval")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"udp_pinger_rtt_p90")),(0,r.kt)("td",{parentName:"tr",align:null},"The P90 RTT for all the packets that returned successfully in the interval")))),(0,r.kt)("p",null,"To view the overall network availability in the NMS UI overview panel, add the\n",(0,r.kt)("inlineCode",{parentName:"p"},"SERVICE_AVAILABILITY_ENABLED")," ",(0,r.kt)("a",{parentName:"p",href:"/docs/runbook/Deployment#deployment-nms-setup-options"},"feature flag"),"\nto the NMS options."),(0,r.kt)("p",{align:"center"},(0,r.kt)("img",{src:"/nms/service_availability.png",width:"240"})))}c.isMDXComponent=!0}}]);